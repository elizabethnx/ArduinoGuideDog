
#include <Servo.h>                           // Include servo library



Servo servoLeft;                             // Declare left servo signal
Servo servoRight;                            // Declare right servo signal
int leftWhisker =4;
int rightWhisker = 3; 
int pirState = LOW;             // we start, assuming no motion detected
int PIR = 7;
int val = 0;                    // variable for reading the pin status
int PIEZOPIN= 2;
int note_A4 = 440;
int note_E5 = 659;
int note_F5 = 698;
int note_C5 = 523;
int note_D5 = 587;
int LED=6;


void setup() {
  delay(40000);
  Serial.begin(9600);
  pinMode(LED, OUTPUT);
  pinMode(leftWhisker, INPUT);
  pinMode(rightWhisker, INPUT);
  pinMode(PIR, INPUT);
  servoLeft.attach(13);                      // Attach left signal to pin 13
  servoRight.attach(12);                     // Attach right signal to pin 12
}
void PIEZO(){
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
}

//void LED(){
//  digitalWrite(LED_BUILTINI, HIGH);
//  delay(1000);
//  digitalWrite(LED_BUILTINI, LOW);
//  delay(1000);
//}

void pIEZO2(){
  tone(PIEZOPIN, note_A4, 200);
  delay(500); 
  tone(PIEZOPIN, note_A4, 200); 
  delay(500);
  tone(PIEZOPIN, note_A4, 200); 
  delay(500); 
  tone(PIEZOPIN, note_D5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_E5, 200); 
  delay(500); 
  tone(PIEZOPIN, note_E5, 200); 
  delay(500); 
}

void touch (){
  servoLeft.writeMicroseconds(1500);
  servoRight.writeMicroseconds(1500);
  delay(500);
  servoRight.writeMicroseconds(1500);
  servoLeft.writeMicroseconds(1500);
  delay(500);
}

  

  
void turn_left (){
  servoLeft.writeMicroseconds(1700);
  servoRight.writeMicroseconds(1500);
}

void back(){
  servoLeft.writeMicroseconds(1300);
  servoRight.writeMicroseconds(1700);
}

void turn_right(){
  servoLeft.writeMicroseconds(90);
  servoRight.writeMicroseconds(90);
}

void loop() {
  
  int leftValue = digitalRead(leftWhisker);
  int rightValue = digitalRead(rightWhisker);
  servoLeft.writeMicroseconds(1700);
  servoRight.writeMicroseconds(1300);
  if (leftValue == 0 || rightValue == 0){
  
    touch();
    if(leftValue == 0 && rightValue== 1){
    delay(500);
    back();
    delay(700);
    turn_left();
    delay(1000);
    }else if (rightValue == 0 && leftValue == 1){
    delay(500);
    back();
    delay(500);
    turn_right();
    delay(1000);
    }
  }
  
  
  val = digitalRead(PIR);
  if(val == 1){
    Serial.println("On");
    PIEZO();
    delay(100);
    touch();
    delay(100);
    turn_right();
    delay(100);
    }else if (val == 0){
    Serial.println("Off");
    pIEZO2();
    delay(100);
    
    servoLeft.writeMicroseconds(1700);
    servoRight.writeMicroseconds(1700);
    turn_left();
    }else{
      Serial.println("didn't touch whisker");
    }
}
  
  

   


  




   


  




   


  



   


  





